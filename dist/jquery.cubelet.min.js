/*! jquery-cubelet - v0.2.0 - 2015-01-12 - https://github.com/jeremyckahn/cubelet */
(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)})(function(e){function t(e,t,n){var o=e._cubeletCoordinates;e.cubeletSetCoords({x:o.x-n,y:o.y+t})}function n(e,t,n){var o=t+n,i=e._cubeletCoordinates.scale>0?1:-1,r=e.cubeletGetCoords().z+i*o;e.cubeletSetCoords({z:r})}function o(o,i,r){var s=r.clientX,a=r.clientY,u=r.clientX-o._lastClientX||0,c=r.clientY-o._lastClientY||0;o._lastClientX=s,o._lastClientY=a,e.contains(o._$cubeletCube[0],i)||o._$cubeletContainer[0]===i?t(o,u,c):e.contains(o._$cubeletZRotationArm[0],i)&&n(o,u,c),o.trigger("change")}function i(t,n){t._lastClientX=n.clientX,t._lastClientY=n.clientY,t._isDragging=!0;var i=e.proxy(o,h,t,n.target);h.on("mousemove",i),h.on("mouseup",function(){t._isDragging=!1,h.off("mousemove",i)})}function r(e,t,n,o,i){t.preventDefault();var r=e._cubeletCoordinates.scale,s=i/d,a=+(r+s).toFixed(4);e._cubeletCoordinates.scale=a,e._$cubeletContainer.css("transform","scale("+a+")"),e.trigger("change")}function s(t,n){if(!t._isDragging){n.stopPropagation();var o=t._proxiedOnWindowMousewheel;o&&h.off("mousewheel",o);var i=e.proxy(r,t,t);t._proxiedOnWindowMousewheel=i,h.on("mousewheel",i),h.one("mousemove",function(){h.off("mousewheel",i)})}}function a(){u=document.createElement("style"),u.innerHTML=b.replace(/__VENDOR__/g,m()),document.head.appendChild(u),c=e(l)}var u,c,l=['<div class="cubelet-container">','<div class="cubelet-cube">','<figure class="cubelet-front"></figure>','<figure class="cubelet-back"></figure>','<figure class="cubelet-right"></figure>','<figure class="cubelet-left"></figure>','<figure class="cubelet-top"></figure>','<figure class="cubelet-bottom"></figure>',"</div>",'<div class="cubelet-rotation-arm">','<div class="cubelet-rotation-handle"></div>',"</div>","</div>"].join(""),b=[".cubelet-container,",".cubelet-cube {","height: 100%;","width: 100%; }",".cubelet-cube {","__VENDOR__transform: translateZ(-100px) rotateY(0deg) rotateX(0deg); ","__VENDOR__transform-style: preserve-3d; }",".cubelet-cube figure {","margin: 0;","position: absolute;","height: 100%;","width: 100%; }",".cubelet-front {","__VENDOR__transform: rotateY(0deg) translateZ(50px); }",".cubelet-back {","__VENDOR__transform: rotateX(180deg) translateZ(50px);","background: #fb0; }",".cubelet-right {","__VENDOR__transform: rotateY(90deg) translateZ(50px);","background: #00cc4e; }",".cubelet-left {","__VENDOR__transform: rotateY(-90deg) translateZ(50px);","background: #06f; }",".cubelet-top {","__VENDOR__transform: rotateX(90deg) translateZ(50px);","background: #f77; }",".cubelet-bottom {","__VENDOR__transform: rotateX(-90deg) translateZ(50px);","background: #b00; }",".cubelet-rotation-arm {","cursor: ew-resize;","bottom: 50%;","background: #fff;","border-left: dotted #000 2px;","left: 50%;","position: absolute;","height: 125px;","width: 0; }",".cubelet-rotation-handle {","background: #444;","border: solid #000 2px;","border-radius: 50%;","height: 10px;","left: -8px;","position: absolute;","right: 8%;","width: 10px; }"].join("\n"),f=100,d=30,_=!1,h=e(window),g={x:0,y:0};h.on("mousemove",function(e){g.x=e.pageX,g.y=e.pageY});var m=function(){var e=document.body.style,t="";return"-webkit-transform"in e?t="-webkit-":"-moz-transform"in e?t="-moz-":"-ms-transform"in e?t="-ms-":"-o-transform"in e&&(t="-o-"),m=function(){return t},t};e.fn.cubeletInit=function(){return _||(a(),_=!0),this._cubeletCoordinates={x:0,y:0,z:0,scale:1},this._lastOffsetX=null,this._lastOffsetY=null,this._$cubeletHtmlFragment=c.clone(),this.append(this._$cubeletHtmlFragment),this._$cubeletContainer=this.find(".cubelet-container"),this._$cubeletCube=this.find(".cubelet-cube"),this._$cubeletZRotationArm=this.find(".cubelet-rotation-arm"),this._$cubeletZRotationHandle=this.find(".cubelet-rotation-handle"),this.css({height:f+"px",width:f+"px"}),this.addClass("cubelet"),this.cubeletSetCoords(this._cubeletCoordinates),this._$cubeletContainer.on("mousedown",e.proxy(i,this,this)),this._$cubeletContainer.on("mousemove",e.proxy(s,this,this)),this},e.fn.cubeletGetCoords=function(){return e.extend({},this._cubeletCoordinates)},e.fn.cubeletSetCoords=function(t){var n=this._cubeletCoordinates;e.extend(n,t);var o="rotateX("+n.x+"deg) rotateY("+n.y+"deg)";return this.css("transform","translate(-50%, -50%) rotate("+n.z+"deg)"),this._$cubeletCube.css("transform",o),this._$cubeletContainer.css("transform","scale("+n.scale+")"),this},e.fn.cubeletShow=function(){this._$cubeletContainer.show();var t=document.elementFromPoint(g.x,g.y);return(e.contains(this._$cubeletContainer[0],t)||this._$cubeletContainer[0]===t)&&this._$cubeletContainer.trigger("mousemove"),this},e.fn.cubeletHide=function(){return this._$cubeletContainer.hide(),this},e.fn.cubeletIsShown=function(){return this._$cubeletContainer.is(":visible")},e.fn.cubeletApplyRotationToElement=function(e){var t=this.cubeletGetCoords();e.css("transform","rotateX("+t.x+"deg) rotateY("+t.y+"deg) rotateZ("+t.z+"deg) scale("+t.scale+")")}});